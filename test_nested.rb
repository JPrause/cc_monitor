cats = ["vmdb", "migrations", "lib", "replication", "vmdb_metrics"]
columns = ["branch", "database"].push(cats).flatten

data = {"4.0.1"=>{"pg"=>{"lib"=>{:name=>"pg-4_0_1-lib", :status=>:success, :url=>"http://cruisecontrol401.manageiq.com:3333/projects/pg-4_0_1-lib", :last_built=>"2012-12-20 15:59:20 UTC", :db=>"pg", :version=>"4.0.1", :category=>"lib"}, "migrations"=>{:name=>"pg-4_0_1-migrations", :status=>:success, :url=>"http://cruisecontrol401.manageiq.com:3333/projects/pg-4_0_1-migrations", :last_built=>"2012-12-20 15:57:07 UTC", :db=>"pg", :version=>"4.0.1", :category=>"migrations"}, "vmdb"=>{:name=>"pg-4_0_1-vmdb", :status=>:success, :url=>"http://cruisecontrol401.manageiq.com:3333/projects/pg-4_0_1-vmdb", :last_built=>"2012-12-20 15:55:01 UTC", :db=>"pg", :version=>"4.0.1", :category=>"vmdb"}, "vmdb_metrics"=>{:name=>"pg-4_0_1-vmdb_metrics", :status=>:success, :url=>"http://cruisecontrol401.manageiq.com:3333/projects/pg-4_0_1-vmdb_metrics", :last_built=>"2012-12-27 06:40:29 UTC", :db=>"pg", :version=>"4.0.1", :category=>"vmdb_metrics"}}, "mssql"=>{"lib"=>{:name=>"mssql-4_0_1-lib", :status=>:success, :url=>"http://cruisecontrolmssql401.manageiq.com:3333/projects/mssql-4_0_1-lib", :last_built=>"2012-12-20 17:14:56 UTC", :db=>"mssql", :version=>"4.0.1", :category=>"lib"}, "migrations"=>{:name=>"mssql-4_0_1-migrations", :status=>:success, :url=>"http://cruisecontrolmssql401.manageiq.com:3333/projects/mssql-4_0_1-migrations", :last_built=>"2012-12-20 17:19:59 UTC", :db=>"mssql", :version=>"4.0.1", :category=>"migrations"}, "vmdb"=>{:name=>"mssql-4_0_1-vmdb", :status=>:success, :url=>"http://cruisecontrolmssql401.manageiq.com:3333/projects/mssql-4_0_1-vmdb", :last_built=>"2012-12-20 17:12:46 UTC", :db=>"mssql", :version=>"4.0.1", :category=>"vmdb"}}}, "4.0.2"=>{"pg"=>{"lib"=>{:name=>"pg-4_0_2-lib", :status=>:success, :url=>"http://cruisecontrol402.manageiq.com:3333/projects/pg-4_0_2-lib", :last_built=>"2012-12-20 15:15:08 UTC", :db=>"pg", :version=>"4.0.2", :category=>"lib"}, "migrations"=>{:name=>"pg-4_0_2-migrations", :status=>:success, :url=>"http://cruisecontrol402.manageiq.com:3333/projects/pg-4_0_2-migrations", :last_built=>"2012-12-20 16:25:31 UTC", :db=>"pg", :version=>"4.0.2", :category=>"migrations"}, "vmdb"=>{:name=>"pg-4_0_2-vmdb", :status=>:success, :url=>"http://cruisecontrol402.manageiq.com:3333/projects/pg-4_0_2-vmdb", :last_built=>"2012-12-20 15:12:57 UTC", :db=>"pg", :version=>"4.0.2", :category=>"vmdb"}}}, "5.0.0"=>{"pg"=>{"lib"=>{:name=>"pg-5_0_0-lib", :status=>:success, :url=>"http://cruisecontrol5.manageiq.com:3333/projects/pg-5_0_0-lib", :last_built=>"2012-12-20 16:26:00 -0500", :db=>"pg", :version=>"5.0.0", :category=>"lib"}, "migrations"=>{:name=>"pg-5_0_0-migrations", :status=>:success, :url=>"http://cruisecontrol5.manageiq.com:3333/projects/pg-5_0_0-migrations", :last_built=>"2012-12-21 14:38:42 -0500", :db=>"pg", :version=>"5.0.0", :category=>"migrations"}, "vmdb"=>{:name=>"pg-5_0_0-vmdb", :status=>:success, :url=>"http://cruisecontrol5.manageiq.com:3333/projects/pg-5_0_0-vmdb", :last_built=>"2012-12-21 14:37:54 -0500", :db=>"pg", :version=>"5.0.0", :category=>"vmdb"}}, "mssql"=>{"lib"=>{:name=>"mssql-5_0_0-lib", :status=>:success, :url=>"http://cruisecontrolmssql5.manageiq.com:3333/projects/mssql-5_0_0-lib", :last_built=>"2012-12-20 14:53:24 -0500", :db=>"mssql", :version=>"5.0.0", :category=>"lib"}, "migrations"=>{:name=>"mssql-5_0_0-migrations", :status=>:success, :url=>"http://cruisecontrolmssql5.manageiq.com:3333/projects/mssql-5_0_0-migrations", :last_built=>"2012-12-21 15:15:57 -0500", :db=>"mssql", :version=>"5.0.0", :category=>"migrations"}, "vmdb"=>{:name=>"mssql-5_0_0-vmdb", :status=>:success, :url=>"http://cruisecontrolmssql5.manageiq.com:3333/projects/mssql-5_0_0-vmdb", :last_built=>"2012-12-21 14:54:38 -0500", :db=>"mssql", :version=>"5.0.0", :category=>"vmdb"}}}, "trunk"=>{"pg"=>{"lib"=>{:name=>"pg-lib", :status=>:success, :url=>"http://cruisecontrol.manageiq.com:3333/projects/pg-lib", :last_built=>"2012-12-20 16:10:14 -0500", :db=>"pg", :version=>"trunk", :category=>"lib"}, "migrations"=>{:name=>"pg-migrations", :status=>:success, :url=>"http://cruisecontrol.manageiq.com:3333/projects/pg-migrations", :last_built=>"2012-12-26 16:11:33 -0500", :db=>"pg", :version=>"trunk", :category=>"migrations"}, "replication"=>{:name=>"pg-replication", :status=>:success, :url=>"http://cruisecontrol.manageiq.com:3333/projects/pg-replication", :last_built=>"2012-12-26 16:14:44 -0500", :db=>"pg", :version=>"trunk", :category=>"replication"}, "vmdb"=>{:name=>"pg-vmdb", :status=>:success, :url=>"http://cruisecontrol.manageiq.com:3333/projects/pg-vmdb", :last_built=>"2012-12-26 14:49:04 -0500", :db=>"pg", :version=>"trunk", :category=>"vmdb"}}, "mssql"=>{"lib"=>{:name=>"mssql-lib", :status=>:success, :url=>"http://cruisecontrolmssql.manageiq.com:3333/projects/mssql-lib", :last_built=>"2012-12-20 15:10:02 -0500", :db=>"mssql", :version=>"trunk", :category=>"lib"}, "migrations"=>{:name=>"mssql-migrations", :status=>:success, :url=>"http://cruisecontrolmssql.manageiq.com:3333/projects/mssql-migrations", :last_built=>"2012-12-26 15:27:56 -0500", :db=>"mssql", :version=>"trunk", :category=>"migrations"}, "vmdb"=>{:name=>"mssql-vmdb", :status=>:success, :url=>"http://cruisecontrolmssql.manageiq.com:3333/projects/mssql-vmdb", :last_built=>"2012-12-26 15:02:21 -0500", :db=>"mssql", :version=>"trunk", :category=>"vmdb"}}, "Server Down! http://cruisecontrol"=>{"metrics.manageiq.com:3333/XmlStatusReport.aspx"=>{:name=>"Server Down! http://cruisecontrol-metrics.manageiq.com:3333/XmlStatusReport.aspx", :status=>:down, :url=>"", :last_built=>"", :db=>"Server Down! http://cruisecontrol", :version=>"trunk", :category=>"metrics.manageiq.com:3333/XmlStatusReport.aspx"}}}} 

count = 0

data.each do |version, projects|
  count += projects.length
  projects.each do |db, categories|
    cats.each do |c|
      puts "#{version.length}"
      puts "#{projects.length}"
      puts "#{db.length}"
      puts "#{version} #{count} #{db} #{c} #{categories[c][:status] unless categories[c].nil?}"
      # categories[c] do |cn, build|
      #   puts build[:name]
      # end
    end
  end
end